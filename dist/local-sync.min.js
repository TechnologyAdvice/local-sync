!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LocalSync=t():e.LocalSync=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return e[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},a=function(e){return localStorage.getItem(e)},i=function(e,t){return localStorage.setItem(e,t)},c=function(e){return localStorage.removeItem(e)},l=function(e){return localStorage.key(e)},s=function(){return localStorage.length},f=function(){function e(){r(this,e),this._bucket=e.DEFAULT_BUCKET}return u(e,[{key:"_mapKeys",value:function(e){for(var t=[],n=s()-1;n>=0;--n){var r=l(n);r.startsWith(this._fullBucket())&&t.unshift(e(this._parseKey(r)))}return t}},{key:"_mapBuckets",value:function(t){for(var n=[],r=s()-1;r>=0;--r){var u=l(r);u.startsWith(e.PREFIX)&&n.unshift(t(this._parseBucket(u)))}return n}},{key:"_fullBucket",value:function(){return[e.PREFIX,this._bucket].join(e.SEPARATOR)}},{key:"_fullKey",value:function(t){return[this._fullBucket(),t].join(e.SEPARATOR)}},{key:"_parseBucket",value:function(t){var n=o(e.PREFIX),r=o(e.SEPARATOR),u=new RegExp(""+n+r+"(.*)"+r),a=t.match(u);return a&&a[1]||void 0}},{key:"_parseKey",value:function(e){var t=this._fullKey("fakeKey").replace("fakeKey",""),n=new RegExp(o(t));return e.replace(n,"")}},{key:"_validateBucket",value:function(t){if("string"!=typeof t)throw new Error('LocalSync "bucket" must be a string.');if(t.includes(" "))throw new Error('LocalSync "bucket" cannot contain spaces.');if(t.includes(e.SEPARATOR))throw new Error('LocalSync "bucket" cannot contain the separator "'+e.SEPARATOR+'".')}},{key:"_validateKey",value:function(t){if("string"!=typeof t)throw new Error('LocalSync "key" parameter must be a string.');if(t.includes(e.SEPARATOR))throw new Error('LocalSync "key" cannot contain the separator "'+e.SEPARATOR+'".')}},{key:"_validateValue",value:function(e){var t=["[object Array]","[object Null]","[object Number]","[object Object]","[object String]","[object Undefined]"],n=Object.prototype.toString.call(e);if(!t.some(function(e){return n===e}))throw new Error('LocalSync "value" of type '+n+" is not supported.")}},{key:"setBucket",value:function(e){return this._validateBucket(e),this._bucket=e,this._bucket}},{key:"getBucket",value:function(){return this._bucket}},{key:"allBuckets",value:function(){return this._mapBuckets(function(e){return e})}},{key:"get",value:function(e){this._validateKey(e);var t=a(this._fullKey(e));try{return"undefined"===t?void 0:JSON.parse(t)}catch(n){throw console.error("Could not JSON.parse() value:",t),n}}},{key:"set",value:function(e,t){return this._validateKey(e),this._validateValue(t),i(this._fullKey(e),JSON.stringify(t)),this.get(e)}},{key:"put",value:function(e,t){return this._validateKey(e),this._validateValue(t),this.set(e,Object.assign(this.get(e),t))}},{key:"remove",value:function(e){this._validateKey(e);var t=this.get(e);return c(this._fullKey(e)),t}},{key:"clear",value:function(){var e=this;this.getAll().forEach(function(t){e.remove(Object.keys(t)[0])})}},{key:"keys",value:function(){return this._mapKeys(function(e){return e})}},{key:"values",value:function(){var e=this;return this._mapKeys(function(t){return e.get(t)})}},{key:"getAll",value:function(){var e=this;return this._mapKeys(function(t){return n({},t,e.get(t))})}}]),e}();f.DEFAULT_BUCKET="default",f.PREFIX="ls",f.SEPARATOR=".",t["default"]=f,e.exports=t["default"]}])});